### Zookeeper 是什么？ 有哪些功能？

- ZooKeeper是一个 分布式的,开放源码的分布式应用程序协调服务。提供的功能有：配置维护,域名服务,分布式同步,组服务等 ,目标就是封装好复杂易出错的关键服务,将简单易用的接口和性能高效、功能稳定的系统提供给用户。
- 集群管理：监控节点的存活状态,运行请求等
- 主节点选举：主节点挂掉了之后可以从备用的节点开始新一轮选主,主节点选举说的就是这个选举的过程,使用Zookeeper可以协助完成这个过程。
- 分布式锁:Zookeeper提供两种锁,独占锁,共享锁,独占锁即一次只有一个线程使用资源,共享锁是读锁共享,读写互斥。
- 命名服务:在分布式系统中,通过命名服务,客户端应用能够根据指定名字来获取资源或服务的地址,提供者等信息。

### 谈下你对ZAB协议的了解？

- ZAB协议是为分布式协调服务ZK专门设计的一种支持崩溃恢复的原子广播协议，ZAB协议包含了两种基本模式：崩溃恢复和消息广播,当整个Zk集群刚刚启动
  或者leader服务器宕机,重启或者网络故障导致不存在过半的服务器与leader服务器保持正常通信时候,所有服务器进入崩溃恢复模式,首先选举产生新的leader
  服务器,然后集群中的Follower服务器与leader服务器进行数据同步,当同步过半后恢复,对外提供正常服务。

### Zookeeper怎么保证主从节点的状态同步？

- Zookeeper的核心是原子广播机制, ZAB协议。
- 恢复模式：当服务启动或者领导这崩溃后,Zab就进入了恢复模式,当领导者被选举出来,其大多数完成了和leader的状态同步,那么恢复模式就结束了
- 广播模式：leader与多数follower进行了状态同步之后,他就可以进行广播消息了。

### Zookeeper几种广播模式？

- 单机部署
- 集群部署
- 伪集群部署

### 说一下Zk的通知机制？

- client端会对某个zNode建立一个watcher事件,当znode发生变化时，这些client会收到zk的通知,然后client可以根据znode变化做出业务上的改变。

### 集群中为什么要有主节点？

- 在分布式环境下,有些业务逻辑只需要及群众的某一台机器进行执行,其他的机器可以共享这个结果,这样可以大大减少重复计算,提高性能,于是 就需要 进行leader选举。

### 集群中有3台服务器,其中有一个宕机,这个时候zk还可以使用吗？

- 可以继续使用,单数服务器只要没超过一般的服务器宕机就可以继续使用 2n+1 n>0 最少3台 集群模式下

### 说一下两阶段提交和三阶段提交的过程?分别有什么问题？

- 两阶段：
    - 投票：
    - 提交执行:

### Zookeeper宕机如何处理？

- zk 集群的机制只要是超过半数的节点正常就可以提供服务。
- Znode:
    - 持久节点： 持久节点,除非手动删除,否则zk节点一直存在于Zk上
    - 临时节点： 临时节点,临时节点的生命周期与客户端会话绑定,一旦客户端会话失效,客户端与zk连接断开不一定会话失效,那么这个客户端创建的所有 临时节点都会被移除。
    - 持久顺序节点：基本相同，增加了一个顺序属性。 由于父节点维护一个自增整型数字。
    - 临时顺序节点：

### Zookeeper和Dubbo的关系？

- Dubbo的将注册中心进行抽象,使得他可以外接不同的存储媒介给注册中心提供服务。
- 引入了Zk作为存储媒介,也就是把Zk的特性引进来,可以进行资源同步,命名服务,以及节点之间的数据和资源进行同步,服务提供者在启动的时候,向 Zk上 的指定节点 /dubbo/serviceName/providers
  目录写入自己的URL地址,这个操作就完成了服务的发布,其他特性还有Mast选举,分布式锁。
  
